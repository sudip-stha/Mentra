{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://D%3A/FYP/mentra/actions/cover-letter.js"],"sourcesContent":["\"use server\";\r\n\r\nimport { db } from \"@/lib/prisma\";\r\nimport { auth } from \"@clerk/nextjs/server\";\r\nimport { GoogleGenerativeAI } from \"@google/generative-ai\";\r\n\r\nconst genAI = new GoogleGenerativeAI(process.env.GEMINI_API_KEY);\r\nconst model = genAI.getGenerativeModel({ model: \"gemini-2.5-flash-lite\" });\r\n\r\nasync function getAuthenticatedUser() {\r\n  const { userId } = await auth();\r\n  if (!userId) throw new Error(\"Unauthorized\");\r\n\r\n  const user = await db.user.findUnique({\r\n    where: { clerkUserId: userId },\r\n    select: {\r\n      id: true,\r\n      industry: true,\r\n      experience: true,\r\n      skills: true,\r\n      bio: true,\r\n    },\r\n  });\r\n\r\n  if (!user) throw new Error(\"User not found\");\r\n  return user;\r\n}\r\n\r\nexport async function generateCoverLetter(data) {\r\n  const user = await getAuthenticatedUser();\r\n\r\n  const prompt = `Write a professional cover letter for a ${\r\n    data.jobTitle\r\n  } position at ${data.companyName}.\r\n\r\nAbout the candidate:\r\n- Industry: ${user.industry}\r\n- Years of Experience: ${user.experience}\r\n- Skills: ${user.skills?.join(\", \") || \"Not specified\"}\r\n- Professional Background: ${user.bio || \"Not provided\"}\r\n\r\nJob Description:\r\n${data.jobDescription}\r\n\r\nRequirements:\r\n1. Use a professional, enthusiastic tone\r\n2. Highlight relevant skills and experience\r\n3. Show understanding of the company's needs\r\n4. Keep it concise (max 400 words)\r\n5. Use proper business letter formatting in markdown\r\n6. Include specific examples of achievements\r\n7. Relate candidate's background to job requirements\r\n\r\nFormat the letter in markdown.`;\r\n\r\n  try {\r\n    const result = await model.generateContent(prompt);\r\n    const content = result.response.text().trim();\r\n\r\n    const coverLetter = await db.coverLetter.create({\r\n      data: {\r\n        content,\r\n        jobDescription: data.jobDescription,\r\n        companyName: data.companyName,\r\n        jobTitle: data.jobTitle,\r\n        status: \"completed\",\r\n        userId: user.id,\r\n      },\r\n    });\r\n\r\n    return coverLetter;\r\n  } catch (error) {\r\n    console.error(\"Error generating cover letter:\", error.message);\r\n    throw new Error(\"Failed to generate cover letter\");\r\n  }\r\n}\r\n\r\nexport async function getCoverLetters() {\r\n  const user = await getAuthenticatedUser();\r\n\r\n  return await db.coverLetter.findMany({\r\n    where: { userId: user.id },\r\n    orderBy: { createdAt: \"desc\" },\r\n    select: {\r\n      id: true,\r\n      jobTitle: true,\r\n      companyName: true,\r\n      status: true,\r\n      createdAt: true,\r\n    },\r\n  });\r\n}\r\n\r\nexport async function getCoverLetter(id) {\r\n  const user = await getAuthenticatedUser();\r\n\r\n  const coverLetter = await db.coverLetter.findUnique({\r\n    where: {\r\n      id,\r\n      userId: user.id,\r\n    },\r\n  });\r\n\r\n  if (!coverLetter) throw new Error(\"Cover letter not found\");\r\n  return coverLetter;\r\n}\r\n\r\nexport async function deleteCoverLetter(id) {\r\n  const user = await getAuthenticatedUser();\r\n\r\n  const coverLetter = await db.coverLetter.findUnique({\r\n    where: {\r\n      id,\r\n      userId: user.id,\r\n    },\r\n  });\r\n\r\n  if (!coverLetter) throw new Error(\"Cover letter not found\");\r\n\r\n  return await db.coverLetter.delete({\r\n    where: { id },\r\n  });\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAEA;AAEA;;AADA;;;;;;AAGA,MAAM,QAAQ,IAAI,8JAAA,CAAA,qBAAkB,CAAC,QAAQ,GAAG,CAAC,cAAc;AAC/D,MAAM,QAAQ,MAAM,kBAAkB,CAAC;IAAE,OAAO;AAAwB;AAExE,eAAe;IACb,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,CAAA,GAAA,mLAAA,CAAA,OAAI,AAAD;IAC5B,IAAI,CAAC,QAAQ,MAAM,IAAI,MAAM;IAE7B,MAAM,OAAO,MAAM,6GAAA,CAAA,KAAE,CAAC,IAAI,CAAC,UAAU,CAAC;QACpC,OAAO;YAAE,aAAa;QAAO;QAC7B,QAAQ;YACN,IAAI;YACJ,UAAU;YACV,YAAY;YACZ,QAAQ;YACR,KAAK;QACP;IACF;IAEA,IAAI,CAAC,MAAM,MAAM,IAAI,MAAM;IAC3B,OAAO;AACT;AAEO,eAAe,uCAAiB,GAAjB,oBAAoB,IAAI;IAC5C,MAAM,OAAO,MAAM;IAEnB,MAAM,SAAS,CAAC,wCAAwC,EACtD,KAAK,QAAQ,CACd,aAAa,EAAE,KAAK,WAAW,CAAC;;;YAGvB,EAAE,KAAK,QAAQ,CAAC;uBACL,EAAE,KAAK,UAAU,CAAC;UAC/B,EAAE,KAAK,MAAM,EAAE,KAAK,SAAS,gBAAgB;2BAC5B,EAAE,KAAK,GAAG,IAAI,eAAe;;;AAGxD,EAAE,KAAK,cAAc,CAAC;;;;;;;;;;;8BAWQ,CAAC;IAE7B,IAAI;QACF,MAAM,SAAS,MAAM,MAAM,eAAe,CAAC;QAC3C,MAAM,UAAU,OAAO,QAAQ,CAAC,IAAI,GAAG,IAAI;QAE3C,MAAM,cAAc,MAAM,6GAAA,CAAA,KAAE,CAAC,WAAW,CAAC,MAAM,CAAC;YAC9C,MAAM;gBACJ;gBACA,gBAAgB,KAAK,cAAc;gBACnC,aAAa,KAAK,WAAW;gBAC7B,UAAU,KAAK,QAAQ;gBACvB,QAAQ;gBACR,QAAQ,KAAK,EAAE;YACjB;QACF;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kCAAkC,MAAM,OAAO;QAC7D,MAAM,IAAI,MAAM;IAClB;AACF;AAEO,eAAe,uCAAa,GAAb;IACpB,MAAM,OAAO,MAAM;IAEnB,OAAO,MAAM,6GAAA,CAAA,KAAE,CAAC,WAAW,CAAC,QAAQ,CAAC;QACnC,OAAO;YAAE,QAAQ,KAAK,EAAE;QAAC;QACzB,SAAS;YAAE,WAAW;QAAO;QAC7B,QAAQ;YACN,IAAI;YACJ,UAAU;YACV,aAAa;YACb,QAAQ;YACR,WAAW;QACb;IACF;AACF;AAEO,eAAe,uCAAY,GAAZ,eAAe,EAAE;IACrC,MAAM,OAAO,MAAM;IAEnB,MAAM,cAAc,MAAM,6GAAA,CAAA,KAAE,CAAC,WAAW,CAAC,UAAU,CAAC;QAClD,OAAO;YACL;YACA,QAAQ,KAAK,EAAE;QACjB;IACF;IAEA,IAAI,CAAC,aAAa,MAAM,IAAI,MAAM;IAClC,OAAO;AACT;AAEO,eAAe,uCAAe,GAAf,kBAAkB,EAAE;IACxC,MAAM,OAAO,MAAM;IAEnB,MAAM,cAAc,MAAM,6GAAA,CAAA,KAAE,CAAC,WAAW,CAAC,UAAU,CAAC;QAClD,OAAO;YACL;YACA,QAAQ,KAAK,EAAE;QACjB;IACF;IAEA,IAAI,CAAC,aAAa,MAAM,IAAI,MAAM;IAElC,OAAO,MAAM,6GAAA,CAAA,KAAE,CAAC,WAAW,CAAC,MAAM,CAAC;QACjC,OAAO;YAAE;QAAG;IACd;AACF;;;IA9FsB;IAiDA;IAgBA;IAcA;;AA/EA,+OAAA;AAiDA,+OAAA;AAgBA,+OAAA;AAcA,+OAAA"}},
    {"offset": {"line": 143, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 149, "column": 0}, "map": {"version":3,"sources":["file://D%3A/FYP/mentra/app/%28main%29/ai-cover-letter/_components/cover-letter-list.jsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/(main)/ai-cover-letter/_components/cover-letter-list.jsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/(main)/ai-cover-letter/_components/cover-letter-list.jsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAgU,GAC7V,8FACA"}},
    {"offset": {"line": 157, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 163, "column": 0}, "map": {"version":3,"sources":["file://D%3A/FYP/mentra/app/%28main%29/ai-cover-letter/_components/cover-letter-list.jsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/(main)/ai-cover-letter/_components/cover-letter-list.jsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/(main)/ai-cover-letter/_components/cover-letter-list.jsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAA4S,GACzU,0EACA"}},
    {"offset": {"line": 171, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 177, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 181, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 187, "column": 0}, "map": {"version":3,"sources":["file://D%3A/FYP/mentra/app/%28main%29/ai-cover-letter/page.jsx"],"sourcesContent":["import { getCoverLetters } from \"@/actions/cover-letter\";\r\nimport Link from \"next/link\";\r\nimport { Plus } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport CoverLetterList from \"./_components/cover-letter-list\";\r\n\r\nexport default async function CoverLetterPage() {\r\n  const coverLetters = await getCoverLetters();\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"flex flex-col md:flex-row gap-2 items-center justify-between mb-5\">\r\n        <h1 className=\"text-6xl font-bold gradient-title\">My Cover Letters</h1>\r\n        <Link href=\"/ai-cover-letter/new\">\r\n          <Button>\r\n            <Plus className=\"h-4 w-4 mr-2\" />\r\n            Create New\r\n          </Button>\r\n        </Link>\r\n      </div>\r\n\r\n      <CoverLetterList coverLetters={coverLetters} />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AAEA;AACA;AAFA;;;;;;;AAIe,eAAe;IAC5B,MAAM,eAAe,MAAM,CAAA,GAAA,0HAAA,CAAA,kBAAe,AAAD;IAEzC,qBACE,8OAAC;;0BACC,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCAAoC;;;;;;kCAClD,8OAAC,4JAAA,CAAA,UAAI;wBAAC,MAAK;kCACT,cAAA,8OAAC,2HAAA,CAAA,SAAM;;8CACL,8OAAC,kMAAA,CAAA,OAAI;oCAAC,WAAU;;;;;;gCAAiB;;;;;;;;;;;;;;;;;;0BAMvC,8OAAC,mLAAA,CAAA,UAAe;gBAAC,cAAc;;;;;;;;;;;;AAGrC"}},
    {"offset": {"line": 260, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}